<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card+ | 분석 리포트</title>
    
    <!--================== CSS ===================-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css">
    <link rel="stylesheet" href="report.css">
    <link rel="stylesheet" href="base.css">

    <!--================== JavaScript ===================-->
    <script src="base.js"></script>
</head>
<body>
    <!--================== 헤더 ===================-->
    <header class="header" id="header">
        <nav>
            <a href="index.html">
                <div class="nav__logo">
                <img src="card+logo.png" alt="logo-img">
                </div>
            </a>
        </nav>
  
        <div class="nav__mypage" id="nav-mypage">
          <div class="mypage">
            <button class="mypage__btn" onclick="toggleDropdown('mypage-list')">마이페이지</button>
            <div class="mypage__list" id="mypage-list">
                <button type="button" class="kakao__login" id="kakao-login-btn">로그인</button>
              <a href="profile.html">프로필</a>
            </div>
          </div>
        </div>
        <div class="nav__menu" id="nav-menu">
          <div class="menu">
            <button class="menu__btn" onclick="toggleDropdown('menu-list')">메뉴</button>
            <div class="menu__list" id="menu-list">
              <a href="report.html" id="report-btn">분석 리포트</a>
              <a href="card_recommend.html">카드 추천</a>
            </div>
          </div>
        </div>
        
        <div class="nav__close" id="nav-close"></div>
      </header>

    <!--================== 분석 리포트 ===================-->
    <div class="title">
        <h1><a href="report.html">분석 리포트</a></h1>
    </div>

    <div class="container">
        <div class="report-header">
            <div class="report-month">
                <h2>11월</h2>
                <div class="total-amount">
                    1,434,336원</div>
                <div class="chart">
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
        
            <div class="analysis">
                <h2>김홍익 님의 소비패턴 분석</h2>
                <span></span>
        
                <div id="categoryList" class="details">
                    <p>
                        <i class="ri-arrow-right-circle-fill"></i>
                        <span>이체</span> 
                        <div class="rate">55.3% | 482,352원</div>
                    </p>
                    <p>
                        <i class="ri-arrow-right-circle-fill"></i>
                        <span>쇼핑</span> 
                        <div class="rate">11.1% | 103,600원</div>
                    </p>
                    <p>
                        <i class="ri-arrow-right-circle-fill"></i>
                        <span>배달앱+간편결제</span> 
                        <div class="rate">11.0% | 100,592원</div>
                    </p>
                    <p>
                        <i class="ri-arrow-right-circle-fill"></i>
                        <span>점심+교통</span> 
                        <div class="rate">10.5% | 99,460원</div>
                    </p>
                    <p>
                        <i class="ri-arrow-right-circle-fill"></i>
                        <span>구독/스트리밍</span> 
                        <div class="rate">10.7% | 95,300원</div>
                    </p>
                </div>
            </div>
        </div>
        
        <div class="cta">
            <p>김홍익 님은 <span>쇼핑</span>에 가장 많은 금액을 소비했어요</p>
        </div>
        
        <div class="arrow">
            <i class="ri-arrow-down-double-line"></i>
        </div>
        
        <div class="cta">
            <p>김홍익 님의 <span>소비패턴</span>에 딱 맞는</p>
            <p>카드 추천 받기</p>
            <a href="card_recommend.html"><div class="footer">
                <p>카드 추천</p>
                <span><i class="ri-arrow-right-s-line"></i></span>
            </div></a>
        </div>
    </div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const categoryData = {
        totalAmount: 1434336,
        categories: [
            { name: "이체", percentage: 55.3, amount: 482352 },
            { name: "쇼핑", percentage: 11.1, amount: 103600 },
            { name: "배달앱+간편결제", percentage: 11.0, amount: 100592 },
            { name: "점심+교통", percentage: 10.5, amount: 99460 },
            { name: "구독/스트리밍", percentage: 10.7, amount: 95300 }
        ]
    };

    let pieChart;

    // 차트를 초기화하는 함수
    function initializeChart() {
        const ctx = document.getElementById('pieChart').getContext('2d');
        pieChart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: categoryData.categories.map(category => category.name),
                datasets: [{
                    data: categoryData.categories.map(category => category.amount),
                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            padding: 20,
                            font: {
                                size: 18
                            }
                        }
                    },
                    tooltip: {
                        bodyFont: {
                            size: 20 // 툴팁 폰트 크기
                        },
                        titleFont: {
                            size: 20 // 툴팁 제목 폰트 크기
                        }
                    }
                }
            }
        });
    }

    // 페이지 로드 시 차트를 초기화하고 카테고리 목록을 채우는 이벤트 리스너
    document.addEventListener("DOMContentLoaded", () => {
        initializeChart();
    });
</script>
</body>
</html>